{
    "sourceFile": "scripts/nextcloud.conf",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1698247567476,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1698247657151,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,8 +12,10 @@\n \n server {\n     listen 443 ssl http2;\n     listen [::]:443 ssl http2;\n+     ssl_certificate /usr/share/nginx/ssl/cert.pem;\n+    ssl_certificate_key /usr/share/nginx/ssl/key.pem;\n     server_name $hostname;\n \n     client_max_body_size 10G;\n     fastcgi_buffers 64 4K;\n"
                },
                {
                    "date": 1698248647301,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,18 +5,18 @@\n \n server {\n     listen 80;\n     listen [::]:80;\n-    server_name $hostname;\n-    return 301 https://$hostname$request_uri;\n+    server_name drive.local;\n+    return 301 https://drive.local$request_uri;\n }\n \n server {\n     listen 443 ssl http2;\n     listen [::]:443 ssl http2;\n      ssl_certificate /usr/share/nginx/ssl/cert.pem;\n     ssl_certificate_key /usr/share/nginx/ssl/key.pem;\n-    server_name $hostname;\n+    server_name drive.local;\n \n     client_max_body_size 10G;\n     fastcgi_buffers 64 4K;\n \n"
                },
                {
                    "date": 1698248813292,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,10 +12,10 @@\n \n server {\n     listen 443 ssl http2;\n     listen [::]:443 ssl http2;\n-     ssl_certificate /usr/share/nginx/ssl/cert.pem;\n-    ssl_certificate_key /usr/share/nginx/ssl/key.pem;\n+    ssl_certificate /etc/letsencrypt/live/drive.local/fullchain.pem;\n+    ssl_certificate_key /etc/letsencrypt/live/drive.local/privkey.pem;\n     server_name drive.local;\n \n     client_max_body_size 10G;\n     fastcgi_buffers 64 4K;\n"
                }
            ],
            "date": 1698247567476,
            "name": "Commit-0",
            "content": "upstream php-handler {\n    #server 127.0.0.1:9000; \n    server unix:/run/php/php8.1-fpm.sock;\n}\n\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name $hostname;\n    return 301 https://$hostname$request_uri;\n}\n\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name $hostname;\n\n    client_max_body_size 10G;\n    fastcgi_buffers 64 4K;\n\n    gzip on;\n    gzip_vary on;\n    gzip_comp_level 4;\n    gzip_min_length 256;\n    gzip_proxied expired no-cache no-store private no_last_modified no_etag auth;\n    gzip_types application/atom+xml application/javascript application/json application/ld+json application/manifest+json application/rss+xml application/vnd.geo+json application/vnd.ms-fontobject application/x-font-ttf application/x-web-app-manifest+json application/xhtml+xml application/xml font/opentype image/bmp image/svg+xml image/x-icon text/cache-manifest text/css text/plain text/vcard text/vnd.rim.location.xloc text/vtt text/x-component text/x-cross-domain-policy;\n\n    add_header Referrer-Policy                      \"no-referrer\"   always;\n    add_header X-Content-Type-Options               \"nosniff\"       always;\n    add_header X-Download-Options                   \"noopen\"        always;\n    add_header X-Frame-Options                      \"SAMEORIGIN\"    always;\n    add_header X-Permitted-Cross-Domain-Policies    \"none\"          always;\n    add_header X-Robots-Tag                        \"noindex, nofollow\" always;\n    add_header X-XSS-Protection                     \"1; mode=block\" always;\n\n    fastcgi_hide_header X-Powered-By;\n\n    root /usr/share/nginx/html/nextcloud;\n\n    index index.php index.html /index.php$request_uri;\n\n    location = / {\n        if ( $http_user_agent ~ ^DavClnt ) {\n            return 302 /remote.php/webdav/$is_args$args;\n        }\n    }\n\n    location = /robots.txt {\n        allow all;\n        log_not_found off;\n        access_log off;\n    }\n\n    location ^~ /.well-known {\n\n        location = /.well-known/carddav { return 301 /remote.php/dav/; }\n        location = /.well-known/caldav  { return 301 /remote.php/dav/; }\n\n        location /.well-known/acme-challenge    { try_files $uri $uri/ =404; }\n        location /.well-known/pki-validation    { try_files $uri $uri/ =404; }\n\n        return 301 /index.php$request_uri;\n    }\n\n    location ~ ^/(?:build|tests|config|lib|3rdparty|templates|data)(?:$|/)  { return 404; }\n    location ~ ^/(?:\\.|autotest|occ|issue|indie|db_|console)                { return 404; }\n\n    location ~ \\.php(?:$|/) {\n        # Required for legacy support\n        rewrite ^/(?!index|remote|public|cron|core\\/ajax\\/update|status|ocs\\/v[12]|updater\\/.+|oc[ms]-provider\\/.+|.+\\/richdocumentscode\\/proxy) /index.php$request_uri;\n\n        fastcgi_split_path_info ^(.+?\\.php)(/.*)$;\n        set $path_info $fastcgi_path_info;\n\n        try_files $fastcgi_script_name =404;\n\n        include fastcgi_params;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        fastcgi_param PATH_INFO $path_info;\n        #fastcgi_param HTTPS on;\n\n        fastcgi_param modHeadersAvailable true;         # Avoid sending the security headers twice\n        fastcgi_param front_controller_active true;     # Enable pretty urls\n        fastcgi_pass php-handler;\n\n        fastcgi_intercept_errors on;\n        fastcgi_request_buffering off;\n        fastcgi_param SERVER_NAME $host;\n    }\n\n    location ~ \\.(?:css|js|svg|gif|map)$ {\n        try_files $uri /index.php$request_uri;\n        expires 6M;         # Cache-Control policy borrowed from `.htaccess`\n        access_log off;     # Optional: Don't log access to assets\n    }\n\n    location ~ \\.(?:woff2?|png|html|ttf|ico|jpg|jpeg|bcmap|mp4|webm)$ {\n        try_files $uri /index.php$request_uri;\n        expires 7d;         # Cache-Control policy borrowed from `.htaccess`\n        access_log off;     # Optional: Don't log access to assets\n    }\n\n    location /remote {\n        return 301 /remote.php$request_uri;\n    }\n\n    location / {\n        try_files $uri $uri/ /index.php$request_uri;\n    }\n\n}"
        }
    ]
}